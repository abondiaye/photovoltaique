{% extends 'admin/layout.html.twig' %}

{% block title %}Admin · Tableau de bord{% endblock %}

{% block admin_body %}
<h1>Tableau de bord</h1>

<div class="row g-3 mb-4">
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <div class="h5">Leads</div>
                <div class="display-6">{{ stats.leads ?? 0 }}</div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <div class="h5">Demandes de maintenance</div>
                <div class="display-6">{{ stats.requests ?? 0 }}</div>
            </div>
        </div>
    </div>
</div>

<div class="row g-4">
    <div class="col-lg-6">
        <h2 class="h5">Leads récents</h2>
        <table class="table table-striped table-bordered admin-table">
            <thead class="table-light">
            <tr><th>Nom</th><th>Email</th><th>Créé le</th></tr>
            </thead>
            <tbody>
            {% for lead in recentLeads ?? [] %}
                <tr>
                    <td>{{ lead.name ?? '—' }}</td>
                    <td>{{ lead.email ?? '—' }}</td>
                    <td>{{ lead.createdAt is defined ? (lead.createdAt|date('d/m/Y H:i')) : '—' }}</td>
                </tr>
            {% else %}
                <tr><td colspan="3" class="text-center text-muted">Aucun lead récent</td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="col-lg-6">
        <h2 class="h5">Demandes récentes</h2>
        <table class="table table-striped table-bordered admin-table">
            <thead class="table-light">
            <tr><th>Client</th><th>Type</th><th>Statut</th><th>Créée le</th></tr>
            </thead>
            <tbody>
            {% for mr in recentRequests ?? [] %}
                <tr>
                    <td>{{ mr.fullName ?? '—' }}</td>
                    <td>{{ mr.type ?? '—' }}</td>
                    <td>{{ mr.status ?? '—' }}</td>
                    <td>{{ mr.createdAt is defined ? (mr.createdAt|date('d/m/Y H:i')) : '—' }}</td>
                </tr>
            {% else %}
                <tr><td colspan="4" class="text-center text-muted">Aucune demande récente</td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
