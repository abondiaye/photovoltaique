<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Photovoltaique{% endblock %}</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  {{ encore_entry_link_tags('app') }}
  <style>
    :root{ --bg1:#0f1220; --bg2:#0b0f1a; --glass:rgba(255,255,255,.08); --stroke:rgba(255,255,255,.15); --accent:#a657ff; --accent2:#00d2ff; }
    *{ box-sizing:border-box }
    body{ margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto; color:#e9ecf1; background:
      radial-gradient(1200px 800px at 20% -10%, #2a184d 0%, transparent 60%),
      radial-gradient(1200px 800px at 120% 10%, #0b6ad3 0%, transparent 50%),
      linear-gradient(160deg, var(--bg1), var(--bg2)); }
    .nav{ display:flex; align-items:center; justify-content:space-between; padding:18px 28px; position:sticky; top:0; backdrop-filter: blur(14px); background: linear-gradient( to bottom, rgba(12,14,24,.7), rgba(12,14,24,.35)); border-bottom:1px solid var(--stroke); z-index:100; }
    .logo{ display:flex; align-items:center; gap:12px; font-weight:800; letter-spacing:.4px }
    .logo-badge{ width:36px; height:36px; border-radius:14px; background: linear-gradient(135deg, var(--accent), var(--accent2)); box-shadow: 0 8px 28px rgba(166,87,255,.35); }
    .nav a{ color:#e9ecf1; text-decoration:none; margin:0 10px; opacity:.9 }
    .hero{ max-width:1200px; margin:48px auto 0; padding:0 24px; display:grid; grid-template-columns: 1.1fr .9fr; gap:28px; align-items:center; }
    .h-title{ font-size:58px; line-height:1.05; margin:0 0 14px; font-weight:800; letter-spacing:-.5px }
    .h-sub{ font-size:18px; opacity:.86; margin:0 0 24px }
    .cta{ display:flex; gap:12px; align-items:center; flex-wrap:wrap }
    .btn{ padding:12px 18px; border-radius:14px; border:1px solid var(--stroke); background: var(--glass); color:#fff; cursor:pointer; backdrop-filter: blur(12px); font-weight:600; text-decoration:none }
    .btn-primary{ background:linear-gradient(135deg, var(--accent), var(--accent2)); border:0; box-shadow: 0 12px 28px rgba(0,210,255,.22) }
    .glass{ background: var(--glass); border:1px solid var(--stroke); border-radius:22px; backdrop-filter: blur(16px); box-shadow: inset 0 1px 0 rgba(255,255,255,.06), 0 8px 30px rgba(0,0,0,.25); }
    .dash{ max-width:1200px; margin:40px auto; padding:0 24px; display:grid; grid-template-columns: repeat(12,1fr); gap:18px }
    .card{ grid-column: span 4; padding:20px; }
    .card.xl{ grid-column: span 8; }
    .kpi{ font-size:34px; font-weight:800; margin-top:4px }
    .footer{ opacity:.6; text-align:center; padding:32px 0; font-size:14px }

    /* ===== Bouton animé (adapté FR) ===== */
    .button{ --white:#ffe7ff; --purple-100:#f4b1fd; --purple-200:#d190ff; --purple-300:#c389f2; --purple-400:#8e26e2; --purple-500:#5e2b83; --radius:18px; border-radius:var(--radius); outline:none; cursor:pointer; font-size:23px; background:transparent; letter-spacing:-1px; border:0; position:relative; width:220px; height:80px; transform:rotate(353deg) skewX(4deg) }
    .bg{ position:absolute; inset:0; border-radius:inherit; filter:blur(1px) }
    .bg::before,.bg::after{ content:""; position:absolute; inset:0; border-radius:calc(var(--radius) * 1.1); background:var(--purple-500) }
    .bg::before{ filter:blur(5px); transition:all 0.3s ease; box-shadow:
      -7px 6px 0 0 rgb(115 75 155 / 40%),
      -14px 12px 0 0 rgb(115 75 155 / 30%),
      -21px 18px 4px 0 rgb(115 75 155 / 25%),
      -28px 24px 8px 0 rgb(115 75 155 / 15%),
      -35px 30px 12px 0 rgb(115 75 155 / 12%),
      -42px 36px 16px 0 rgb(115 75 155 / 8%),
      -56px 42px 20px 0 rgb(115 75 155 / 5%); }
    .wrap{ border-radius:inherit; overflow:hidden; height:100%; transform:translate(6px, -6px); padding:3px; background: linear-gradient(to bottom, var(--purple-100) 0%, var(--purple-400) 100%); position:relative; transition:all 0.3s ease; }
    .outline{ position:absolute; overflow:hidden; inset:0; opacity:0; outline:none; border-radius:inherit; transition:all 0.4s ease; }
    .outline::before{ content:""; position:absolute; inset:2px; width:120px; height:300px; margin:auto; background: linear-gradient(to right, transparent 0%, white 50%, transparent 100%); animation: spin 3s linear infinite; animation-play-state: paused; }
    .content{ pointer-events:none; display:flex; align-items:center; justify-content:center; z-index:1; position:relative; height:100%; gap:16px; border-radius: calc(var(--radius) * 0.85); font-weight:600; transition:all 0.3s ease; background: linear-gradient(to bottom, var(--purple-300) 0%, var(--purple-400) 100%); box-shadow: inset -2px 12px 11px -5px var(--purple-200), inset 1px -3px 11px 0px rgb(0 0 0 / 35%); }
    .content::before{ content:""; inset:0; position:absolute; z-index:10; width:80%; top:45%; bottom:35%; opacity:.7; margin:auto; background: linear-gradient(to bottom, transparent, var(--purple-400)); filter: brightness(1.3) blur(5px); }
    .char{ transition: all 0.3s ease; display:flex; align-items:center; justify-content:center; }
    .char span{ display:block; color:transparent; position:relative; }
    .char span:nth-child(7){ margin-left:5px; } /* petit espace visuel */
    .char.state-1 span:nth-child(7){ margin-right:-3px; }
    .char.state-1 span{ animation: charAppear 1.2s ease backwards calc(var(--i) * 0.03s); }
    .char.state-1 span::before, .char span::after{ content: attr(data-label); position:absolute; color: var(--white); text-shadow:-1px 1px 2px var(--purple-500); left:0; }
    .char span::before{ opacity:0; transform: translateY(-100%); }
    .char.state-2{ position:absolute; left:60px; }
    .char.state-2 span::after{ opacity:1; }
    .icon{ animation: resetArrow 0.8s cubic-bezier(0.7, -0.5, 0.3, 1.2) forwards; z-index:10; }
    .icon div, .icon div::before, .icon div::after{ height:3px; border-radius:1px; background-color: var(--white); }
    .icon div::before, .icon div::after{ content:""; position:absolute; right:0; transform-origin:center right; width:14px; border-radius:15px; transition: all 0.3s ease; }
    .icon div{ position:relative; width:24px; box-shadow:-2px 2px 5px var(--purple-400); transform: scale(0.9); background: linear-gradient(to bottom, var(--white), var(--purple-100)); animation: swingArrow 1s ease-in-out infinite; animation-play-state: paused; }
    .icon div::before{ transform: rotate(44deg); top:1px; box-shadow:1px -2px 3px -1px var(--purple-400); animation: rotateArrowLine 1s linear infinite; animation-play-state: paused; }
    .icon div::after{ bottom:1px; transform: rotate(316deg); box-shadow:-2px 2px 3px 0 var(--purple-400); background: linear-gradient(200deg, var(--white), var(--purple-100)); animation: rotateArrowLine2 1s linear infinite; animation-play-state: paused; }
    .path{ position:absolute; z-index:12; bottom:0; left:0; right:0; stroke-dasharray:150 480; stroke-dashoffset:150; pointer-events:none; }
    .splash{ position:absolute; top:0; left:0; pointer-events:none; stroke-dasharray:60 60; stroke-dashoffset:60; transform: translate(-17%, -31%); stroke: var(--purple-300); }
    .button:hover .wrap{ transform: translate(8px, -8px); }
    .button:hover .outline{ opacity: 1; }
    .button:hover .outline::before, .button:hover .icon div::before, .button:hover .icon div::after, .button:hover .icon div{ animation-play-state: running; }
    .button:active .bg::before{ filter: blur(5px); opacity: 0.7; box-shadow:
      -7px 6px 0 0 rgb(115 75 155 / 40%),
      -14px 12px 0 0 rgb(115 75 155 / 25%),
      -21px 18px 4px 0 rgb(115 75 155 / 15%); }
    .button:active .content{ box-shadow: inset -1px 12px 8px -5px rgba(71, 0, 137, 0.4), inset 0px -3px 8px 0px var(--purple-200); }
    .button:active .wrap{ transform: translate(3px, -3px); }
    .button:active .splash{ animation: splash 0.8s cubic-bezier(0.3, 0, 0, 1) forwards 0.05s; }
    .button:focus .path{ animation: path 1.6s ease forwards 0.2s; }
    .button:focus .icon{ animation: arrow 1s cubic-bezier(0.7, -0.5, 0.3, 1.5) forwards; }
    @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
    @keyframes charAppear{0%{transform:translateY(50%);opacity:0;filter:blur(20px)}20%{transform:translateY(70%);opacity:1}50%{transform:translateY(-15%);opacity:1;filter:blur(0)}100%{transform:translateY(0);opacity:1}}
    @keyframes swingArrow{50%{transform:translateX(5px) scale(0.9)}}
    @keyframes rotateArrowLine{50%{transform:rotate(30deg)}80%{transform:rotate(55deg)}}
    @keyframes rotateArrowLine2{50%{transform:rotate(330deg)}80%{transform:rotate(300deg)}}
    @keyframes resetArrow{0%{transform:translateX(-128px)}100%{transform:translateX(0)}}
    @keyframes path{from{stroke:white}to{stroke-dashoffset:-480;stroke:#f9c6fe}}
    @keyframes splash{to{stroke-dasharray:2 60; stroke-dashoffset:-60}}

    /* Bot */
    .bot{ position: fixed; bottom: 22px; right: 22px; }
    .bot-toggle{ border:0; border-radius:20px; padding:12px 16px; background:linear-gradient(135deg,var(--accent),var(--accent2)); color:#fff; font-weight:700; cursor:pointer; box-shadow:0 14px 38px rgba(0,0,0,.35) }
    .bot-panel{ width:340px; height:440px; display:none; flex-direction:column; overflow:hidden; }
    .bot-header{ padding:12px 14px; border-bottom:1px solid var(--stroke); display:flex; align-items:center; justify-content:space-between }
    .bot-body{ padding:12px; gap:8px; display:flex; flex-direction:column; overflow:auto }
    .bot-msg{ padding:10px 12px; border-radius:14px; background:rgba(255,255,255,.06); border:1px solid var(--stroke) }
    .bot-input{ display:flex; gap:8px; padding:12px; border-top:1px solid var(--stroke) }
    .bot-input input{ flex:1; padding:10px 12px; border-radius:12px; border:1px solid var(--stroke); background:rgba(0,0,0,.2); color:#fff }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="logo"><span class="logo-badge"></span> Photovoltaique</div>
    <div>
      <a href="#features">Fonctionnalités</a>
      <a href="#devis">Devis</a>
      <a href="#realisations">Réalisations</a>
      <a href="#contact">Contact</a>
    </div>
  </nav>

  {% block body %}{% endblock %}

  <div class="footer">
    © {{ "now"|format_datetime(locale='fr', pattern='d MMMM yyyy') }} Photovoltaique — Tous droits réservés
  </div>

  <div class="bot">
    <button class="bot-toggle" id="botToggle">Demander un devis</button>
    <div class="bot-panel glass" id="botPanel">
      <div class="bot-header">
        <strong>Conseiller Solaire</strong>
        <button class="btn" id="botClose">✕</button>
      </div>
      <div class="bot-body" id="botBody">
        <div class="bot-msg">Bonjour ! Je peux estimer votre installation. Quelle surface de toit (m²) ?</div>
      </div>
      <div class="bot-input">
        <input id="botInput" placeholder="Écrivez votre message…"/>
        <button class="btn btn-primary" id="botSend">Envoyer</button>
      </div>
    </div>
  </div>

  {{ encore_entry_script_tags('app') }}
  <script>
    const p = document.getElementById('botPanel');
    const t = document.getElementById('botToggle');
    const c = document.getElementById('botClose');
    const i = document.getElementById('botInput');
    const s = document.getElementById('botSend');
    const b = document.getElementById('botBody');

    const open = () => { p.style.display = 'flex'; };
    const close = () => { p.style.display = 'none'; };
    t.onclick = open; c.onclick = close;

    s.onclick = () => {
      const v = i.value.trim(); if(!v) return;
      const add = (text, me=false)=>{ const m=document.createElement('div'); m.className='bot-msg'; m.textContent=text; if(me) m.style.background='rgba(166,87,255,.18)'; b.appendChild(m); b.scrollTop=b.scrollHeight; };
      add(v, true); i.value='';
      const roof = parseFloat(v.replace(',', '.'));
      if(!isNaN(roof)){
        const kwp = Math.max(1, Math.min(15, roof * 0.15));
        const kwh = Math.round(kwp * 1100);
        add(`Estimation: ~${kwp.toFixed(1)} kWc, ${kwh} kWh/an. Souhaitez-vous recevoir un devis par email ?`);
      } else {
        add('Merci ! Indiquez une surface (en m²) ou laissez votre email.');
      }
    };
  </script>
</body>
</html>
