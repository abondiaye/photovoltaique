{% extends 'base.html.twig' %}

{% block title %}Détails demande #{{ request.id }}{% endblock %}

{% block body %}
<div class="container mt-4">
    <h1>🔎 Détails de la demande #{{ request.id }}</h1>

    <div class="card">
        <div class="card-header">
            <strong>{{ request.fullName }}</strong> — {{ request.email }}
        </div>
        <div class="card-body">
            <p><strong>📞 Téléphone :</strong> {{ request.phone ?? 'Non renseigné' }}</p>
            <p><strong>🏠 Adresse :</strong> {{ request.addressLine1 }}{% if request.addressLine2 %}, {{ request.addressLine2 }}{% endif %}, {{ request.postalCode }} {{ request.city }}</p>

            <p><strong>🛠 Type de demande :</strong>
                {% if request.type == constant('App\\\\Entity\\\\MaintenanceRequest::TYPE_CLEANING') %}
                    🧹 Nettoyage
                {% elseif request.type == constant('App\\\\Entity\\\\MaintenanceRequest::TYPE_INSPECTION') %}
                    🔎 Inspection
                {% elseif request.type == constant('App\\\\Entity\\\\MaintenanceRequest::TYPE_REPAIR') %}
                    🛠 Réparation
                {% endif %}
            </p>

            <p><strong>🗓 Date souhaitée :</strong> {{ request.requestedDate|date('d/m/Y H:i') }}</p>

            <p><strong>💬 Commentaire :</strong> {{ request.comment ?? 'Aucun commentaire' }}</p>

            <p><strong>📸 Photos :</strong>
                {% if request.photos is not empty %}
                    <ul>
                        {% for photo in request.photos %}
                            <li><a href="{{ asset(photo) }}" target="_blank">Voir photo</a></li>
                        {% endfor %}
                    </ul>
                {% else %}
                    Aucune photo fournie
                {% endif %}
            </p>

            <p><strong>📌 Statut :</strong>
                {% if request.status == constant('App\\\\Entity\\\\MaintenanceRequest::STATUS_PENDING') %}
                    <span class="badge bg-secondary">⏳ En attente</span>
                {% elseif request.status == constant('App\\\\Entity\\\\MaintenanceRequest::STATUS_CONFIRMED') %}
                    <span class="badge bg-primary">✅ Confirmée</span>
                {% elseif request.status == constant('App\\\\Entity\\\\MaintenanceRequest::STATUS_DONE') %}
                    <span class="badge bg-success">✔ Terminée</span>
                {% elseif request.status == constant('App\\\\Entity\\\\MaintenanceRequest::STATUS_CANCELLED') %}
                    <span class="badge bg-danger">❌ Annulée</span>
                {% endif %}
            </p>

            <p><strong>🕒 Créée le :</strong> {{ request.createdAt|date('d/m/Y H:i') }}</p>
            <p><strong>🔄 Mise à jour :</strong> {{ request.updatedAt|date('d/m/Y H:i') }}</p>
        </div>
    </div>

    <div class="mt-3">
        <a href="{{ path('app_maintenance_request_index') }}" class="btn btn-secondary">⬅ Retour à la liste</a>
        <a href="{{ path('app_maintenance_request_edit', {id: request.id}) }}" class="btn btn-warning">✏ Modifier</a>

        {{ include('maintenance_request/_delete_form.html.twig') }}
    </div>
</div>
{% endblock %}
